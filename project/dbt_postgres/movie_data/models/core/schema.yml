version: 2

models:
    - name: dim_languages
      description: List of unique movie release languages from ISO 639-1
      columns:
          - name: language_record_id
            description: Unique ID (primary key) for the record
            tests:
                - unique:
                    severity: warn
                - not_null:
                    severity: warn
          - name: full_language_name
            description: The full movie release language name, in English
          - name: language_key
            description: The ISO 639-1 language abbreviation

    - name: dim_genres
      description: List of genre ID's generated by TMDB and their respective genre names
      columns:
          - name: genre_id
            description: Unique ID (primary key) for the record
            tests:
                - unique:
                    severity: warn
                - not_null:
                    severity: warn
                - relationships:
                    to: ref('dim_genres_bridge')
                    field: 'genre_id'
                    severity: warn
          - name: genre_name
            description: The movie genre name, in English

    - name: dim_genres_bridge
      description: A bridge table to link the movie fact table with the genre dimension table
      columns:
          - name: genre_key
            description: Unique ID (primary key) for the record, potentially a combination of genre ID's
            tests:
                # - unique:
                #     severity: warn
                - not_null:
                    severity: warn
          - name: genre_id
            description: The split-out movie genre ID from the unique genre key
            tests:
              - relationships:
                  to: ref('dim_genres')
                  field: 'genre_id'
                  severity: warn

    - name: fact_movies
      description: All movie data from TMDB, uniquely identified by record_id
      columns:
          - name: record_id
            description: Primary key for this table, a surrogate key generated by Postgres
            tests:
                - unique:
                    severity: warn
                - not_null:
                    severity: warn